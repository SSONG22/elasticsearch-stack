

## 01 엘라스틱 스택이란

1.1 탄생

- 사이트 내에서 전문 검색(full text search)기능을 제공하는 강력한 소프트웨어의 필요성
- 아파치 루씬 - 1999년 더그 커팅에 의해 개발
    - 전문 인덱싱과 검색 기능을 요구하는 애플리케이션에 사용
    - Elasticsearch, Solr

1.2 발전

- 검색 엔진 → 플랫폼
- 다양한 사용 사례를 유연하게 지원
- 2012년 엘라스틱 서치 + 로그 스태시 + 키바나 = 엘라스틱 스택 개발
- 2015년 패킷비트와의 연합으로 비츠도 포함해 지금의 엘라스틱 스택 구조가 되었다.
    - 시각화 - 키바나
    - 데이터 저장 & 검색 엔진 - 엘라스틱서치
    - 데이터 수집 - 비츠, 로그스태시

1.3 구성요소

- 엘라스틱서치: 분산 검색 엔진
    - 내부적으로 각 도큐먼트를 인덱싱하고 빠르게 검색하는데 사용하는 기술
    - 모든 레코드를 JSON 도큐먼트 형태로 입력하고 관리한다.
    - 일종의 NoSQL 과 비슷하다.
    - 루씬의 기능(데이터별로 최적화된 자료구조, 스코어링)을 분산 시스템으로 확장해 성능, 유연성, 활용성 면에서 개선되었다.
    - 모든 통신을 REST API을 써서 접근성과 활용성을 높였다.
    
    <단점>
    
    - 저장공간이 크게 압축되지 않고 시스템 리소스를 많이 사용한다.
    - 인덱스가 불변의 자료구조이기 때문에 도큐먼트를 수정,삭제 비용이 저렴하지 않다.
- 키바나: 시각화와 엘라스틱서치 관리 도구
    - 엘라스틱 스택의 UI를 담당한다.
- 로그 스태시: 이벤트 수집과 정제를 위한 도구
    - 데이터 수집과 가공 기능을 제공
    - 필터 기능을 이용해 비정형이나 반정형 데이터를 분석하기 쉬운 형태로 정제할 수 있고
- 비츠: 엣지단에서 동작하는 경량 수집 도구
    - 실제 서비스가 동작하는 호스트에 수집기를 설치해서 이벤트 정보를 수집할 때 사용
    - 파일비트, 메트릭 비트 등 경량 수집기 포함

1.4 용도

- 전문(full text) 검색엔진
    - 빅데이터에서 역인덱싱 기법을 이용해 전문 검색을 해야할 때 사용
    - 용어 분석을 위한 다양한 언어별 분석기 준비, 유사도 스코어링을 위한 다양한 방법 제공
    - 엘라스틱서치는 원문을 저장할 필요가 없다 → 용량 차지 X, 빠른 성능
    - 레플리카 수를 늘려 검색성능을 높일 수 있다
- 로그 통합 분석
    - 여러 장비와 서비스에서 발생하는 로그를 통합하고 검색하는데 최적화됨
    - 엘라스틱서치에 저장된 데이터들에 대한 교차 분석, 연관 분석을 쉽게 할 수 있다.
- 보안 이벤트 분석 (SIEM)
    - 머신러닝 모델과 특정 알고리즘을 통해 알려지지 않은 위협도 밝혀 낼 수 있다.
- 애플리케이션 성능 분석 (APM)
    - 프로그래밍 언어별 에이전트를 통해 성능 지표 수집을 돕고 분석을 위한 UI를 제공한다.
- 머신러닝
    - 유료 라이선스를 구매해야 사용할 수 있다.

1.5 빅데이터 플랫폼의 일부로 동작하는 엘라스틱 스택

- 엔터프라이즈 데이터 버스인 카프카와 연동
    - ‘비츠에서 수집한 각 장비의 이벤트를 카프카로 전송하고 이를 로그 스태시로 다시 읽기’
    또는 ‘카프카에 저장된 다른 시스템의 이벤트를 엘라스틱서치로 읽기’
        
         구성으로 자주 사용된다. 
        
    - 장점: 정상적인 인덱싱이 불가능할 때도 데이터 유실 방지, 타 시스템과 데이터 연계가 쉬워짐
- 하둡 생태계와 연동
    - 엘라스틱서치: 인덱싱된 결과에 대해 빠른 검색 제공 + 스파크: 기존에 인덱싱되지 않은 데이터에 대한 빠른 일괄 처리를 제공
        
        ⇒ 엘라스틱서치를 중간 집계 엔진이나 결과를 저장해 재활용 용도로 활용가능 
        
- 관계형 데이터베이스와 연동
    - 로그 스태시는 관계형 데이터베이스와 연계할 수 있는 다양한 방법을 제공한다.
    - 기존 관계형 데이터베이스에 저장된 데이터를 인덱싱하거나 입력받는 이벤트에 정보를 주입하는 등 여러 용도로 쓰인다.

1.6 유사 제품과의 비교

- 엘라스틱서치의 유사 제품군
    - 솔라 - 정적 데이터를 처리하기에 적합, 주키퍼 의존
    - 데이터베이스와 비교
    
    |  | 엘라스틱서치 | 몽고디비 | MySQL |
    | --- | --- | --- | --- |
    | 분류 | 검색 엔진 | 도큐먼트 저장소 | 관계형 데이터베이스 |
    | 최초 릴리스  | 2010년 | 2009년 | 1995년 |
    | 스키마 | 자동 생성 | 자유 | 필요 |
    | 인터페이스 | REST API  | 전용 프로토콜 | JDBC/ODBC |
    | 분산 저장 | 샤딩 | 샤딩 | 별도 제품으로 지원  |
    | 트랜잭션 | 미지원 | 부분 지원 | 지원 |
    | JOIN | 미지원 | 최근 도큐먼트 단위로 지원 시작 | 지원 |
    | 특징 | 다양한 데이터 유형에 대한 빠른 검색/집계 | 높은 활용성/범용성 | 뛰어난 데이터 무결성  |
- 로그스태시/비츠의 유사 제품군
    - 플루언트디(Fluentd)
        - 트레저 데이터에서 개발
        - CNCF스택에 쿠버네티스나 오픈트레이싱을 사용하는 경우 사용
- 키바나의 유사 제품군
    
    
    |  | 키바나 | 그라파나 | 태블로 |
    | --- | --- | --- | --- |
    | 실행환경 | 웹 서비스 | 웹 서비스 | 설치/웹 서비스 모두 제공 |
    | 데이터 소스 | 엘라스틱서치 | 엘라스틱 서치, 
    그라파이트,
    몽고디비,
    프로메테우스 등 | 관계형 데이터베이스,
    엑셀 파일,
    JSON 파일,
    드롭박스 등  |
    | 특징 | 실시간 대시보드 외에도 캔버스, 지도, 비츠/로그스태시와 연계되어 제공되는 솔루션 등 엘라스틱 서치의 기능을 활용한 다양한 시각화 세트 제공  | 라인, 바 차트 등 기본적이지만 인프라 모니터링에 부족함이 없는 시각화 요소들을 포함한 실시간 대시보드 제공
    시계열 데이터 베이스를 활용할 수 있음  | 실시간보다는 다양화 시각화 도구를 이용한 분석에 특화되어 있음. 다양한 데이터 소스를 활용한 시각화 가능 |
    | 기타 기능 지원 | 스택 관리, 모니터링 등 엘라스틱 스택 특화 기능 지원. 알림이나 머신러닝 등 유료 기능 존재 | 알림 기능 지원  |  |
- 엘라스틱 스택의 유사 제품군
    - 엘라스틱 스택
        - 커스텀 가능
        - 무료로 제공
    - 스플렁크
        - 대용량 로그 분석을 위한 엔터프라이즈 제품
        - 제동되는 앱들이 다양하고 수집기나 대시보드가 더 잘 만들어져있다
        - 유료옵션만 제공

1.7 체계적인 문서와와 활발한 공동체 지원

[공식문서](https://www.elastic.co/guide/index.html)

[공식 블로그](https://www.elastic.co/kr/blog/) 

[엘라스틱 포럼](https://discuss.elastic.co/)
